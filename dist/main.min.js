var $jscomp={scope:{},getGlobal:function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global?global:c}};$jscomp.global=$jscomp.getGlobal(this);$jscomp.patches={};$jscomp.patch=function(c,a){($jscomp.patches[c]=$jscomp.patches[c]||[]).push(a);var d=$jscomp.global;c=c.split(".");for(var h=0;h<c.length-1&&d;h++)d=d[c[h]];c=c[c.length-1];d&&d[c]instanceof Function&&(d[c]=a(d[c]))};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};if(!$jscomp.global.Symbol){$jscomp.global.Symbol=$jscomp.Symbol;var c=[],a=function(a){return function(h){c=[];h=a(h);for(var b=[],l=0,n=h.length;l<n;l++){var k;a:if(k=h[l],k.length<$jscomp.SYMBOL_PREFIX.length)k=!1;else{for(var g=0;g<$jscomp.SYMBOL_PREFIX.length;g++)if(k[g]!=$jscomp.SYMBOL_PREFIX[g]){k=!1;break a}k=!0}k?c.push(h[l]):b.push(h[l])}return b}};$jscomp.patch("Object.keys",a);$jscomp.patch("Object.getOwnPropertyNames",a);$jscomp.patch("Object.getOwnPropertySymbols",
function(d){return function(h){a.unused=Object.getOwnPropertyNames(h);c.push.apply(d(h));return c}})}};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(c){return $jscomp.SYMBOL_PREFIX+c+$jscomp.symbolCounter_++};$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();$jscomp.global.Symbol.iterator||($jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));$jscomp.initSymbolIterator=function(){}};
$jscomp.makeIterator=function(c){$jscomp.initSymbolIterator();var a=c[Symbol.iterator];if(a)return a.call(c);var d=0;return{next:function(){return d<c.length?{done:!1,value:c[d++]}:{done:!0}}}};
define("#plug-task#lib/task",["require","exports"],function(c,a){function d(e){e=q.indexOf(e);-1<e&&q.splice(e,1)}function h(e,a,b){for(;0<e.length;){var d=m.get(e.shift());d&&d.resume(a,b,!1)}}function b(e){return Error("E"+e+": "+["Not in plug-task runtime context","Task has detached"][e%10])}function l(){if(-1===g){for(;0<q.length;)g=(g+1)%q.length,f=q[g],f.run();f=null;g=-1}}function n(e){if(-1==g)b(100);else{if(e.is_done())return e.result;e.is_detach()?b(101):(e.join(f.id),f.suspend())}}var k=
1,g=-1,f=null,m=new Map,q=[],r="object"==typeof process&&process.hrtime;r||(r=function(e){var a=Date.now();return e?[(a-e[0])/1E3]:[a]});var p=function(e,a,b){var d=this;this.generator=e;this.parent_tid=a;for(this.comment=b;m.has(k);)k=(k&268435455)+1;this.id=k;this.result=null;this.status=1;this.detached=!1;this.data=new Map;this.join_task_ids=[];m.set(this.id,this);q.push(this);this.comment||(this.comment="Task<#"+this.id+">");this.callback_success=function(e){d.resume(!1,e,!0)};this.callback_error=
function(e,a){e?d.resume(!0,e,!0):d.resume(!1,a,!0)}};p.prototype.exit=function(e){if(this.is_done())return!1;m.delete(this.id);this.status=3;this.result=e;d(this);h(this.join_task_ids,!0,e);l();return!0};p.prototype.detach=function(){this.parent_tid=0;this.detached=!0};p.prototype.is_done=function(){var e=this.status;return 4==e||3==e};p.prototype.is_detach=function(){return this.detached};p.prototype.join=function(e){-1==this.join_task_ids.indexOf(e)&&this.join_task_ids.push(e)};p.prototype.suspend=
function(){return 1==this.status?(this.status=2,d(this),!0):!1};p.prototype.resume=function(e,a,b){2==this.status&&(this.is_error=e,this.result=a,this.status=1,q.push(this),b&&l())};p.prototype.get_data=function(e,a){var b;return this.data.has(e)?this.data.get(e):(b=m.get(this.parent_tid))?b.get_data(e,a):a};p.prototype.set_data=function(e,a){this.data.set(e,a)};p.prototype.run=function(){var e=this.is_error,a=this.result,b=!1,c=this.generator,l=r();do{try{if(a=e?c.throw(a):c.next(a),e=!1,b=a.done,
a=a.value,!b){if(a&&a.then instanceof Function){this.suspend();a.then(this.callback_success,this.callback_error);break}continue}}catch(f){e=!0,a=f}m.delete(this.id);this.status=4;d(this);h(this.join_task_ids,e,a);e&&console.log("%s uncaughtException:\n%s\n",this.comment,a.toString(),a);break}while(1===this.status&&(1===q.length||1>r(l)[0]));this.is_error=e;this.result=a};a.throw_error=b;a.get=function(a){return m.get(a)};a.run=l;a.start=function(a,b){a=new p(a,f?f.id:0,b);l();return a};a.self=function(){f||
b(100);return f};a.self_id=function(){f||b(100);return f.id};a.join=n;a.join_all=function(a){function b(f,g){for(;;)switch(d){case 0:l=$jscomp.makeIterator(a),h=l.next();case 1:if(h.done){d=3;break}c=h.value;d=4;return{value:n(c),done:!1};case 4:if(void 0===g){d=5;break}d=-1;throw g;case 5:case 2:h=l.next();d=1;break;case 3:d=-1;default:return{value:void 0,done:!0}}}var d=0,c,h,l,f={next:function(a){return b(a,void 0)},throw:function(a){return b(void 0,a)},return:function(a){throw Error("Not yet implemented");
}};$jscomp.initSymbolIterator();f[Symbol.iterator]=function(){return this};return f};a.sleep=function(a){f?(setTimeout(f.callback_success,a),f.suspend()):b(100)};a.suspend=function(){f?f.suspend():b(100)};a.get_data=function(a,d){if(f)return f.get_data(a,d);b(100)};a.set_data=function(a,d){if(f)return f.set_data(a,d);b(100)}});
define("#plug-task#lib/util",["require","exports","#plug-task#lib/task"],function(c,a,d){a.warp=function(a){return function(){var b=d.self();b?(Array.prototype.push.call(arguments,b.callback_success,b.callback_error),a.apply(this,arguments),b.suspend()):d.throw_error(100)}};a.thunk=function(a){return function(){var b=d.self();b?(Array.prototype.push.call(arguments,b.callback_error),a.apply(this,arguments),b.suspend()):d.throw_error(100)}};a.custom=function(a,b){return function(){var c=d.self();c?
(Array.prototype.push.call(arguments,b.bind(this,c.callback_error,c.callback_success)),a.apply(this,arguments),c.suspend()):d.throw_error(100)}}});
define("#plug-task#lib/queue",["require","exports","#plug-task#lib/task"],function(c,a,d){c=function(a,b,d){this.size=a;this.queues=[];this.current=0;this.put_waits=[];this.get_waits=[];if(b)if("number"==typeof b)for(;0<b--;)this.queues.push(d);else this.queues=b.slice(0);this.current=this.queues.length};c.prototype.put=function(a){function b(b,f){for(;;)switch(c){case 0:if(!(0<g.size&&g.current>=g.size)){c=1;break}g.put_waits.push(d.self_id());c=2;return{value:d.suspend(),done:!1};case 2:if(void 0===
f){c=3;break}c=-1;throw f;case 3:return g.queues.push(a),c=-1,{value:g.current,done:!0};case 1:case 4:if(!(0<g.get_waits.length)){c=5;break}k=g.get_waits.shift();n=d.get(k);if(!n){c=6;break}n.resume(!1,a,!0);c=-1;return{value:0,done:!0};case 6:c=4;break;case 5:return g.queues.push(a),c=-1,{value:++g.current,done:!0};default:return{value:void 0,done:!0}}}var c=0,n,k,g=this,f={next:function(a){return b(a,void 0)},throw:function(a){return b(void 0,a)},return:function(a){throw Error("Not yet implemented");
}};$jscomp.initSymbolIterator();f[Symbol.iterator]=function(){return this};return f};c.prototype.get=function(){function a(h,m){for(;;)switch(b){case 0:if(!(0>=f.current)){b=1;break}f.get_waits.push(d.self_id());b=2;return{value:d.suspend(),done:!1};case 2:if(void 0===m){b=3;break}b=-1;throw m;case 3:return g=h,b=-1,{value:g,done:!0};case 1:case 4:if(!(0<f.put_waits.length)){b=5;break}k=f.put_waits.shift();n=d.get(k);if(!n){b=6;break}c=f.queues.shift();n.resume(!1,null,!0);b=-1;return{value:c,done:!0};
case 6:b=4;break;case 5:return f.current--,b=-1,{value:f.queues.shift(),done:!0};default:return{value:void 0,done:!0}}}var b=0,c,n,k,g,f=this,m={next:function(b){return a(b,void 0)},throw:function(b){return a(void 0,b)},return:function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();m[Symbol.iterator]=function(){return this};return m};a.Queue=c});
define(["require","exports","#plug-task#lib/task","#plug-task#lib/util","#plug-task#lib/queue"],function(c,a,d,h,b){a.run=d.run;a.start=d.start;a.self=d.self;a.self_id=d.self_id;a.join=d.join;a.join_all=d.join_all;a.sleep=d.sleep;a.suspend=d.suspend;a.get_data=d.get_data;a.set_data=d.set_data;a.warp=h.warp;a.thunk=h.thunk;a.custom=h.custom;a.Queue=b.Queue;a.VERSION="0.1.0"});
